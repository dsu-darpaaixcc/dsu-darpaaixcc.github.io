<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Plugins - DSU AIxCC</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">DSU AIxCC</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../../.." class="nav-link">CRS Homepage</a>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Technical Docs <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../outline/" class="dropdown-item">General</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">AI & ML</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../AI%20%26%20ML/outline/" class="dropdown-item">Outline</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">API</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../Endpoints/" class="dropdown-item">API Endpoints Documentation</a>
</li>
            
<li>
    <a href="../General/" class="dropdown-item">General</a>
</li>
            
<li>
    <a href="./" class="dropdown-item active">Plugins</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Utils</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Utils/Logging/" class="dropdown-item">Logging</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Web</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../Web/outline/" class="dropdown-item">Outline</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">User Docs <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../../User%20Docs/Overview/" class="dropdown-item">Overview</a>
</li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">API</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../User%20Docs/API/Endpoints/" class="dropdown-item">API Endpoints Documentation</a>
</li>
            
<li>
    <a href="../../../User%20Docs/API/outline/" class="dropdown-item">Outline</a>
</li>
    </ul>
  </li>
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Web Interface</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="../../../User%20Docs/Web%20Interface/outline/" class="dropdown-item">Outline</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../General/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../../Utils/Logging/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#plugins" class="nav-link">Plugins</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#plugin-loader" class="nav-link">Plugin Loader</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#plugin-code-template" class="nav-link">Plugin Code Template</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="plugins">Plugins</h1>
<p>Plugins are pieces of code that <code>plugin</code> to the CRS (or any flask app really, please steal this design if you want for your own projects). In the case of the CRS, the plugins are primarily model based, meaning they exist to interact with specific models. </p>
<p>Plugins are great for modularity, as you can work exclusively on your "plugin", and as long as a few items are met, have it literally "plug in" to the project. Additionally, if one breaks, no biggie as it just gets skipped while the rest load. </p>
<p>Ex:</p>
<ul>
<li>
<p>C Plugin: </p>
<ul>
<li>
<p>interacts with a model tied to C</p>
</li>
<li>
<p>May have the following endpoints:</p>
<ul>
<li>
<p>/api/model/c/detect-vulnerabilites</p>
</li>
<li>
<p>/api/model/c/fix-vulnerabilites</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="plugin-loader">Plugin Loader</h2>
<p>Loads plugins from the <code>Model</code> folder. Each Subfolder contains a plugin, which is a template/framework class that gets loaded on the API startup. </p>
<p>This function is currenly in the Api.py file, named <code>load_plugins</code>. It's a tad bit messy, with about 3 nested loops, and could use a rework, but functions as expected, so it's fine for now.</p>
<p>In a nutshell, the loader does the following:</p>
<ol>
<li>Finds the plugin (or in this case, <code>model</code>) directory</li>
<li>Iterates over the folders in the directory</li>
<li>in each folder, searches for a py file.</li>
<li>Imports that Py file</li>
<li>Pulls needed items from Py file &amp; Info class (Class name, Plugin Name, Plugin Path, etc)</li>
<li>Takes the Class of the plugin, initializes it, passes in the <code>app</code> (the flask app instance), and runs the <code>main</code> method.</li>
<li>If the <code>main</code> method is setup correctly (see example below), it should register all of its routes with the flask app, and start.</li>
</ol>
<h2 id="plugin-code-template">Plugin Code Template</h2>
<p>The following is a bare minumum of what a plugin should contain, and what it needs to successfully work: </p>
<pre><code>from Utils.Logger import LoggingSingleton

################################################
# Info class
################################################
'''Info class
Fill in your info for the plugin here. This is defined near the top, so it's accessible
by anything that may need it.
'''
class Info:
    name    = &quot;ExamplePlugin&quot;
    author  = &quot;author_name&quot;
    endpoint = &quot;/api/model/endpoint&quot;
    classname = &quot;ClassName&quot;

class ClassName():
    def __init__(self, app):
        self.logger = LoggingSingleton.get_logger()
        self.app = app

################################################
# Main Stuff
################################################

    # main function for the plugin, gets called by the plugin loader
    def main(self):
        '''
        Main function/entry point for the plugin. Called when plugin is loaded
        '''
        self.logger.debug(f&quot;Loading {Info.name}&quot;)
        self._register_routes()

    ## Put all the routes here.
    def _register_routes(self):
        self.app.route(f'{Info.endpoint}', methods = [&quot;GET&quot;])(self.model_endpoint)
        self.app.route(f'{Info.endpoint}/predict', methods = [&quot;POST&quot;])(self.model_predict)

    # note, change/delete this method. Multiple methods accross the project with the same name &amp; registered routes will cause issues
    def example_endpoint(self):
        '''
        example endpoint

        '''
        # do whatever you want here, call other funcs/classes, etc. Just make sure 
        # it returns a value if it's mapped to an endpoint

        # Calculate last digit of pi
        # Find the meaning of life

        return jsonify({&quot;status&quot;:f&quot;Plugin {Info.name} successfully started&quot;})

</code></pre></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/jquery-3.6.0.min.js"></script>
        <script src="../../../js/bootstrap.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
